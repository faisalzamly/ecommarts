{% extends 'base.html' %} {% block style %}
<style>
    .brand {
        text-align: center;
        font-size: 60px;
        margin-top: -25px;
        color: #ff6f61;
        background-color: wheat;
        padding: 5px 0;
    }
    
    .current {
        color: #bd1100 !important;
        background: #000000!important;
        border-color: #bd1100!important;
    }
</style>{% endblock %} {% load static %} {% block body %}
<!-- Breadcrumb Start -->
<div class="breadcrumb-wrap">
    <div class="container-fluid">
        <ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'home'  %}">Home</a></li>
            <li class="breadcrumb-item">{% if category %}
                <a href="{% url 'product_category' category.pk %}">{{category.name}}</a> {% elif ProductsPrand %}
                <a href="{% url 'product_prand_list' ProductsPrand.pk %}">{{ProductsPrand.name}}</a> {% else %}

                <a href="{% url 'product_list'  %}">Products</a> {% endif %}</li>
            <li class="breadcrumb-item active">Product List</li>
        </ul>
    </div>
</div>
<!-- Breadcrumb End -->

<!-- Product List Start -->
<div class="product-view">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-8">
                <div class="row">
                    <div class="col-md-12">
                        <div class="product-view-top">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="product-search">
                                        <input type="email" value="Search">
                                        <button><i class="fa fa-search"></i></button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="product-short">
                                        <div class="dropdown">
                                            {% if order_style %}
                                            <div class="dropdown-toggle" data-toggle="dropdown">{{order_style}}</div>{% else%}
                                            <div class="dropdown-toggle" data-toggle="dropdown">Product short by</div>{% endif%}

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="{% url 'orderd_product_list' 1 %}" class="dropdown-item">Newest</a>
                                                <a href="#" class="dropdown-item">Popular</a>
                                                <a href="#" class="dropdown-item">Most sale</a>
                                                <a href="{% url 'orderd_product_list' 2 %}" class="dropdown-item">Oldest</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="product-price-range">
                                        <div class="dropdown">
                                            <div class="dropdown-toggle" data-toggle="dropdown">{% if price_text %} {{price_text}} {% else%} Product price range {% endif %}</div>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                {% if category %}
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 1 %}" class="dropdown-item">$0 to $50</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 2 %}" class="dropdown-item">$51 to $100</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 3 %}" class="dropdown-item">$101 to $150</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 4 %}" class="dropdown-item">$151 to $200</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 5 %}" class="dropdown-item">$201 to $250</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 6 %}" class="dropdown-item">$251 to $300</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 7 %}" class="dropdown-item">$301 to $350</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 8 %}" class="dropdown-item">$351 to $400</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 9 %}" class="dropdown-item">$401 to $450</a>
                                                <a href="{% url 'product_list_priceAndCategory' category.pk 10 %}" class="dropdown-item">$451 to $3000</a> {% else %}

                                                <a href="{% url 'product_list_price' 1 %}" class="dropdown-item">$0 to $50</a>
                                                <a href="{% url 'product_list_price' 2 %}" class="dropdown-item">$51 to $100</a>
                                                <a href="{% url 'product_list_price' 3 %}" class="dropdown-item">$101 to $150</a>
                                                <a href="{% url 'product_list_price' 4 %}" class="dropdown-item">$151 to $200</a>
                                                <a href="{% url 'product_list_price' 5 %}" class="dropdown-item">$201 to $250</a>
                                                <a href="{% url 'product_list_price' 6 %}" class="dropdown-item">$251 to $300</a>
                                                <a href="{% url 'product_list_price' 7 %}" class="dropdown-item">$301 to $350</a>
                                                <a href="{% url 'product_list_price' 8 %}" class="dropdown-item">$351 to $400</a>
                                                <a href="{% url 'product_list_price' 9 %}" class="dropdown-item">$401 to $450</a>
                                                <a href="{% url 'product_list_price' 10 %}" class="dropdown-item">$451 to $3000</a>{% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if ProductsPrand %}
                    <div class="col-md-12">
                        <h1 class="brand">{{ProductsPrand.name}}</h1>
                    </div>
                    {% elif tag %}
                    <div class="col-md-12">
                        <h1 class="brand">#{{tag.name}}</h1>
                    </div>
                    {% endif %}
                    <div class="row col-md-12" id="Allproducts">
                        <div class=" col-lg-12 sidebar ">
                            <h1>h111</h1>
                        </div>
                        <br> {% for product in products %}
                        <div class="col-md-4">
                            <a href="{% url 'product_Details' product.pk %}">
                                <div class="product-item">
                                    <div class="product-title">
                                        <a href="{% url 'product_Details' product.pk %}">{{product.name}}  </a>
                                        <div class="ratting">
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                        </div>
                                    </div>
                                    <div class="product-image">

                                        <a href="{% url 'product_Details' product.pk %}">
                                            <img src="{{product.image.url}}" height="300px" alt="Product Image {{ product.pk}} {{imgea.product}}">
                                        </a>


                                        <div class="product-action">

                                            <a href="{% url 'product_Details' product.pk %}"><i class="fa fa-cart-plus"></i></a>
                                            <a href="#"><i class="fa fa-heart"></i></a>
                                            <a href="#"><i class="fa fa-search"></i></a>

                                        </div>

                                    </div>
                                    <div class="product-price">
                                        <h3><span>$</span>{{product.price}}</h3>
                                        <a class="btn" href=""><i class="fa fa-shopping-cart"></i>Buy Now</a>
                                    </div>
                                </div>
                            </a>
                        </div>
                        {% endfor %}
                    </div>

                </div>

                <!-- Pagination Start -->
                <div class="col-md-12">
                    <nav aria-label="Page navigation example">

                        <p style="text-align: center;">Current Page:
                            <b id="currentPage">
                                </b>
                        </p>

                        <ul class="pagination justify-content-center">
                            <li class="page-item ">
                                <a class="page-link" href="#" id="prev">Previous</a>
                            </li>
                            <div style="display: flex; flex-direction: row;" id="page_paginator">

                            </div>

                            <li class="page-item">
                                <a class="page-link" href="#" id="next">Next</a>
                            </li>
                        </ul>
                    </nav>
                </div>
                <!-- Pagination Start -->
            </div>

            <!-- Side Bar Start -->
            <div class="col-lg-4 sidebar">
                <div class="sidebar-widget category">
                    <h2 class="title">Category</h2>
                    <nav class="navbar bg-light">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'product_list' %}"><i class="fa fa-microchip"></i>All Products</a>
                            </li>
                            {% for cat in categories %}
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'product_category' cat.pk %}"><i class="fa fa-microchip"></i>{{cat.name}}</a>
                            </li>
                            {% endfor %}
                        </ul>
                    </nav>
                </div>

                <div class="sidebar-widget widget-slider">
                    <div class="sidebar-slider normal-slider">
                        <div class="product-item">
                            <div class="product-title">
                                <a href="#">Product Name</a>
                                <div class="ratting">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                </div>
                            </div>
                            <div class="product-image">
                                <a href="product-detail.html">
                                    <img src="img/product-10.jpg" alt="Product Image">
                                </a>
                                <div class="product-action">
                                    <a href="#"><i class="fa fa-cart-plus"></i></a>
                                    <a href="#"><i class="fa fa-heart"></i></a>
                                    <a href="#"><i class="fa fa-search"></i></a>
                                </div>
                            </div>
                            <div class="product-price">
                                <h3><span>$</span>99</h3>
                                <a class="btn" href=""><i class="fa fa-shopping-cart"></i>Buy Now</a>
                            </div>
                        </div>
                        <div class="product-item">
                            <div class="product-title">
                                <a href="#">Product Name</a>
                                <div class="ratting">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                </div>
                            </div>
                            <div class="product-image">
                                <a href="product-detail.html">
                                    <img src="img/product-9.jpg" alt="Product Image">
                                </a>
                                <div class="product-action">
                                    <a href="#"><i class="fa fa-cart-plus"></i></a>
                                    <a href="#"><i class="fa fa-heart"></i></a>
                                    <a href="#"><i class="fa fa-search"></i></a>
                                </div>
                            </div>
                            <div class="product-price">
                                <h3><span>$</span>99</h3>
                                <a class="btn" href=""><i class="fa fa-shopping-cart"></i>Buy Now</a>
                            </div>
                        </div>
                        <div class="product-item">
                            <div class="product-title">
                                <a href="#">Product Name</a>
                                <div class="ratting">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                </div>
                            </div>
                            <div class="product-image">
                                <a href="product-detail.html">
                                    <img src="img/product-8.jpg" alt="Product Image">
                                </a>
                                <div class="product-action">
                                    <a href="#"><i class="fa fa-cart-plus"></i></a>
                                    <a href="#"><i class="fa fa-heart"></i></a>
                                    <a href="#"><i class="fa fa-search"></i></a>
                                </div>
                            </div>
                            <div class="product-price">
                                <h3><span>$</span>99</h3>
                                <a class="btn" href=""><i class="fa fa-shopping-cart"></i>Buy Now</a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-widget brands">
                    {% if prands %}
                    <h2 class="title">Our Brands</h2>
                    <ul>
                        {% if category %}{% for prand in prands %}
                        <li><a href="{% url 'product_category_prand_list' category.pk prand.pk %}">{{prand.name}} </a><span>&nbsp; ({{prand.count}})</span></li>{% endfor %} {% else %} {% for prand in prands %}
                        <li><a href="{% url 'product_prand_list' prand.pk %}">{{prand.name}} </a><span>&nbsp; ({{prand.count}})</span></li>{% endfor %}{% endif %}


                    </ul>
                    {% endif %}
                </div>

                <div class="sidebar-widget tag">
                    {% if tags %}
                    <h2 class="title">Tags Cloud</h2>
                    {%for tag in tags %}
                    <a href="{% url 'product_tag_list' tag.pk %}">{{tag.name}}</a> {% endfor %} {% endif %}
                </div>
            </div>
            <!-- Side Bar End -->
        </div>
    </div>
</div>
<!-- Product List End -->

<!-- Brand Start -->
<div class="brand">
    <div class="container-fluid">
        <div class="brand-slider">
            <div class="brand-item"><img src="static/img/brand-1.png" alt=""></div>
            <div class="brand-item"><img src="static/img/brand-2.png" alt=""></div>
            <div class="brand-item"><img src="static/img/brand-3.png" alt=""></div>
            <div class="brand-item"><img src="static/img/brand-4.png" alt=""></div>
            <div class="brand-item"><img src="static/img/brand-5.png" alt=""></div>
            <div class="brand-item"><img src="static/img/brand-6.png" alt=""></div>
        </div>
    </div>
</div>


<!-- Brand End -->



{% endblock %}{% block script %}
<script>
    // alert('aaaa')
    async function getData(url, page, paginateBy) {
        // alert('aaaa')
        const urlWithParams = url + "?" + new URLSearchParams({
            page: page,
            per_page: paginateBy
        })
        const response = await fetch(urlWithParams);
        return response.json();
    }
    class FauxPaginator {

        constructor(perPage) {

            this.perPage = perPage
            this.pageIndex = 1
            console.log("el")
            this.container = document.getElementById("Allproducts")
            this.elements = document.querySelectorAll("pre")

            this.label = document.getElementById("currentPage")
            this.page_paginator = document.getElementById("page_paginator")
            this.prev = document.getElementById("prev")
            this.next = document.getElementById("next")

            this.prev.addEventListener("click", this.onPrevClick.bind(this))
            this.next.addEventListener("click", this.onNextClick.bind(this))
            console.log("el2")
            this.goToPage()
        }
        onPrevClick(event) {
            event.preventDefault()
            this.pageIndex--;
            this.goToPage()
            document.body.scrollTop = document.documentElement.scrollTop = 170;

        }
        onNextClick(event) {
            event.preventDefault()
            this.pageIndex++;
            this.goToPage()
            document.body.scrollTop = document.documentElement.scrollTop = 170;

        }
        addElement(pk, name, price, imge, product) {
            const divContaner = document.createElement("div")
            divContaner.classList.add("col-md-4")
            const pig_a = document.createElement("a")
            const url_to_product_Detiles = 'product/' + pk;
            // pig_a.setAttribute("href", url_to_product_Detiles)

            const divproductItem = document.createElement("div")
            divContaner.classList.add("product-item")
            const divproductTitle = document.createElement("div")
            divproductTitle.classList.add("product-title")
                // title
            const title_a = document.createElement("a")
            title_a.setAttribute("href", url_to_product_Detiles)
            title_a.append(document.createTextNode(name))
            divproductTitle.append(title_a)
                // Rating
            const divRating = document.createElement("div")
            divRating.classList.add("ratting")
            for (let i = 0; i < 5; i++) {
                const ii = document.createElement("i")
                ii.classList.add("fa-star")
                ii.classList.add("fa")
                divRating.append(ii)
            }
            divproductTitle.append(divRating)
            divproductItem.appendChild(divproductTitle)
                // Product Imge
            const divImge = document.createElement("div")
            divImge.classList.add("product-image")
            const imge_a = document.createElement("a")
            imge_a.setAttribute("href", url_to_product_Detiles)
            const imge_img = document.createElement("img")
                // var imge_path = "media" + imge
            imge_img.setAttribute("src", imge)
            imge_img.setAttribute("height", "300px")
            imge_img.setAttribute("alt", "Product Image")
            imge_a.append(imge_img)
            divImge.append(imge_a)

            // Product action
            const divAction = document.createElement("div")
            divAction.classList.add("product-action")
            const btn_add_to_cart = document.createElement("button")
            btn_add_to_cart.classList.add("btn")
            btn_add_to_cart.classList.add("update-cart")
            btn_add_to_cart.setAttribute("data-product", pk)
            btn_add_to_cart.setAttribute("data-action", "add")
            btn_add_to_cart.setAttribute("type", "button")
            btn_add_to_cart.addEventListener('click', function() {
                var productId = this.dataset.product
                var action = this.dataset.action
                console.log("productID:", productId, "action:", action)

                console.log('USER:', user)
                if (user == 'AnonymousUser') {
                    console.log('Not Logged in')
                } else {
                    updateUserOrder(productId, action)

                }
            })


            // const action_a = document.createElement("a")

            // action_a.setAttribute("href", url_to_product_Detiles)
            const ii = document.createElement("i")
            ii.classList.add("fa-cart-plus")
            ii.classList.add("fa")
            btn_add_to_cart.append(ii)
            const action_a2 = document.createElement("a")
                // action_a2.setAttribute("href", url_to_product_Detiles)
            const ii2 = document.createElement("i")
            ii2.classList.add("fa-heart")
            ii2.classList.add("fa")
            action_a2.append(ii2)
            const action_a3 = document.createElement("a")
                // action_a3.setAttribute("href", url_to_product_Detiles)
            const ii3 = document.createElement("i")
            ii3.classList.add("fa-search")
            ii3.classList.add("fa")
            action_a3.append(ii3)
            divAction.append(btn_add_to_cart)
            divAction.append(action_a2)
                // divAction.append(action_a3)
            divImge.append(divAction)
            divproductItem.appendChild(divImge)
                // productPrice
            const divPrice = document.createElement("div")
            divPrice.classList.add("product-price")
            const h3_Price = document.createElement("h3")
            const span_Price = document.createElement("span")
            span_Price.append(document.createTextNode("$"))
            h3_Price.appendChild(span_Price)
            h3_Price.appendChild(document.createTextNode(price))
            const btn_a = document.createElement("a")

            btn_a.setAttribute("href", url_to_product_Detiles)

            btn_a.classList.add("btn")
            const ii_buy = document.createElement("i")
            ii_buy.classList.add("fa-shopping-cart")
            ii_buy.classList.add("fa")
            btn_a.appendChild(ii_buy)
            btn_a.appendChild(document.createTextNode("Buy Now"))
            divPrice.append(h3_Price)
            divPrice.append(btn_a)
                // finishing
            divproductItem.appendChild(divPrice)
            pig_a.append(divproductItem)
            divContaner.appendChild(pig_a)


            this.container.append(divContaner)
        }
        goToPage() {
            console.log("el3");
            getData("{% url 'products-api' %}", this.pageIndex, this.perPage)

            .then(response => {
                console.log("el4")
                this.container.innerHTML = '';
                response.data.forEach((el) => {
                    console.log(el.pk)
                    console.log(el.name)
                    console.log(el.price)
                    console.log(el.pk)
                    this.addElement(el.pk, el.name, el.price, el.imge, el)

                });
                console.log("consol output");



                // this.label.innerText = this.pageIndex;

                const firstPage = this.pageIndex === 1
                const lastPage = !response.page.has_next

                this.prev.style.display = firstPage ? "none" : "inline-block"
                this.next.style.display = lastPage ? "none" : "inline-block"
                this.label.innerHTML = "" + this.pageIndex;
                this.page_paginator.innerHTML = ''
                for (let i = 1; i <= response.page.page_range; i++) {
                    const li_page = document.createElement("li")
                    li_page.classList.add("page-item")
                    const a_page = document.createElement("a")
                    a_page.classList.add("page-link")
                    if (i == this.pageIndex) {
                        a_page.classList.add("current")
                    }
                    a_page.appendChild(document.createTextNode(i))

                    a_page.addEventListener("click", () => {
                        this.pageIndex = a_page.innerHTML;
                        this.goToPage()
                        document.body.scrollTop = document.documentElement.scrollTop = 170;
                    });
                    li_page.appendChild(a_page)

                    this.page_paginator.append(li_page)
                }



            });
        }
    }
    new FauxPaginator(9);
</script> {% endblock %};